<progress data-loading></progress>

<nav hx-target="#body-main" hx-push-url="true">
  <ul>
    <li>
      <a class="logo" href="#" hx-get="/">
        {% include "logo.svg" %}
      </a>
    </li>
  </ul>
  <ul>
    {% if not session["login"] %}
    <li>
      <a role="button" href="#" _="
        on click
          halt the event
          get value of <[name=login]/> in #register-form
          set value of <[name=login]/> in #login-form to it as String
          toggle @hidden on .login-register
        end">
          <span class="login-register">{{ L["Sign up"] }}</span>
          <span class="login-register" hidden>{{ L["Sign in"] }}</span>
      </a>
    </li>
    {% else %}
    {% if "system" in session.get("acl", []) or "user" in session.get("acl", []) %}
    <li>
      <details class="dropdown" hx-on:click="event.target.nodeName==='A'?this.open=false:null">
        <summary>ðŸ§°</summary>
        <ul dir="ltr">
          <li>
            <a href="#" class="secondary" hx-get="/objects/projects">{{ L["Projects"] }}</a>
          </li>
          <li>
            <a href="#" class="secondary" hx-get="/objects/cars">{{ L["Cars"] }}</a>
          </li>
          <li>
            <a href="#" class="secondary" hx-get="/processings">{{ L["AI recognition"] }}</a>
          </li>
          {% if "system" in session.get("acl", []) %}
          <li>
            <hr>
            <small>{{ L["Access"] }}</small>
          </li>
          <li>
            <a href="#" hx-get="/users">{{ L["Users"] }}</a>
          </li>
          <li>
            <a href="#" hx-get="/groups">{{ L["User groups"] }}</a>
          </li>
          <li>
            <hr>
            <small>{{ L["System"] }}</small>
          </li>
          <li>
            <a href="#" hx-get="/system/logs">{{ L["Logs"] }}</a>
          </li>
          <li>
            <a href="#" hx-get="/system/settings">{{ L["Settings"] }}</a>
          </li>
          <li>
            <a href="#" hx-get="/system/status">{{ L["Health"] }}</a>
          </li>
          {% endif %}
        </ul>
      </details>
    </li>
    {% endif %}
    <li>
      <details class="dropdown" hx-on:click="event.target.nodeName==='A'?this.open=false:null">
        <summary>ðŸ‘¤ {{ session.login }}</summary>
        <ul dir="ltr">
          <li>
            <a href="#" hx-get="/profile/">{{ L["Profile"] }}</a>
          </li>
          <li>
            <hr>
            <a href="#" hx-post="/logout" hx-swap="innerHTML">{{ L["Sign out"] }}</a>
          </li>
        </ul>
      </details>
    </li>
    <li>
      <a href="" id="vault-dialog-toggle" class="no-text-decoration shine"
        _="on click halt the event add @open to #vault-dialog add .no-interaction to body call (first .vault-unlock-pin in #vault-dialog).focus() end">
        <span aria-busy="true"></span>
      </a>
    </li>
    {% endif %}
  </ul>
</nav>

<div class="grid-space-between" id="nav-meta">
  <div>
    {% if session["login"] %}{{ L["Connection"] }} {% endif %}<span id="ws-indicator" hx-swap-oob="outerHTML"></span>
    <div hx-target="#body-main">
      {% if session["login"] %}{{ L["Path"] }} {% endif %}<span id="ws-path"></span>
    </div>
  </div>
  <div>{{ L["Theme"] }}: <a href="#" _="install navTheme"></a></div>
</div>

{% if session["login"] %}
<dialog id="vault-dialog" _="install vaultDialog">
  <article>
    <p class="grid-space-between">
      <b>{{ L["Vault"] }}</b>
      <a href="#" _="on click halt the event remove @open from closest <dialog/> remove .no-interaction from body end">{{ L["Close"] }}</a>
    </p>
    <hr>
    <fieldset id="vault-unlock-fieldset">
      <label>{{ L["Vault password"] }}</label>
      <input hx-disable
        class="vault-unlock-pin"
        name="vault-unlock-pin"
        type="password"
        autocomplete="off"
        autocorrect="off"
        data-protonpass-ignore="true"
        autocapitalize="off"
        spellcheck="false"/>
      <small>{{ L["Your vault will be kept unlocked until you refresh the window or lock it"] }}</small>
    </fieldset>
    <button class="vault-unlock" data-vault='{{ session.profile.vault or "" }}'>...</button>
  </article>
</dialog>
{% endif %}
