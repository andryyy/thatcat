{% set sorting_direction = "asc" if session.get(request.view_args.get("object_type") ~ "_sorting")[1] == False else "desc" %}
{% set sorting_attr = session.get(request.view_args.get("object_type") ~ "_sorting")[0] %}

<tr id="{{ request.view_args.get("object_type") }}-table-navigation-row">
  <td class="table-navigation" colspan="2">
    <div class="grid-space-between">
      <div>
        <select name="page_size" data-loading-disable form="{{ request.view_args.get("object_type") }}-table-search" _="on change trigger submit on #{{ request.view_args.get("object_type") }}-table-search">
          <option {{ "selected" if data.page_size == 1 }} value="1">1</option>
          <option {{ "selected" if data.page_size == 5 }} value="5">5</option>
          <option {{ "selected" if data.page_size == 10 }} value="10">10</option>
          <option {{ "selected" if data.page_size == 20 }} value="20">20</option>
          <option {{ "selected" if data.page_size == 50 }} value="50">50</option>
          <option {{ "selected" if data.page_size == 100 }} value="100">100</option>
          <option {{ "selected" if data.page_size == -1 }} value="-1">{{ L["All"] }}</option>
        </select>
        <small>{{ L["Items per page"] }}</small>
      </div>

      <div {{ "hidden" if data.total == 0 }}>
        <select name="page" data-loading-disable form="{{ request.view_args.get("object_type") }}-table-search" _="on change trigger submit on #{{ request.view_args.get("object_type") }}-table-search">
        {% for page in range(1, data.total_pages + 1) %}
          <option {{ "selected" if page == data.page }} value="{{ page }}">{{ page }} / {{ data.total_pages }}</option>
        {% endfor %}
        </select>
        <small>{{ L["Page"] }}</small>
      </div>
    </div>

    <div class="grid-space-between">
      <div _="on click from <.paging:not(.disabled)/> in me set value of <[name='page']/> in closest <tr/> to target's @data-value then trigger submit on #{{ request.view_args.get("object_type") }}-table-search end">
        <code class="paging {{ "disabled" if data.page <= 1 else "pointer" }}" data-value="1">❰❰</code>
        <code class="paging {{ "disabled" if not data.has_prev else "pointer" }}" data-value="{{ data.page - 1 }}">❬</code>
        <code class="paging {{ "disabled" if not data.has_next else "pointer" }}" data-value="{{ data.page + 1 }}">❭</code>
        <code class="paging {{ "disabled" if data.page == data.total_pages else "pointer" }}" data-value="{{ data.total_pages }}">❱❱</code>
      </div>

      <div>
        <b><span id="{{- request.view_args.get("object_type") -}}-count">{{- data.page_size if data.total >= data.page_size and data.page_size > 0 else data.total -}}/{{- data.total -}}</span></b> {{ L["Elements"] }}
      </div>
    </div>

    {% include "objects/includes/objects/table_filters/" ~ request.view_args.get("object_type") ~ ".html" %}

    <div>
      {% if request.view_args.get("object_type") == "cars" %}
        {% set attributes = ["vin", "created", "updated"] %}
      {% elif request.view_args.get("object_type") == "projects" %}
        {% set attributes = ["name", "created", "updated"] %}
      {% endif %}

      {% for attribute in attributes %}
      <button class="sorting {{ "secondary outline" if sorting_attr != attribute }}" data-loading-disable
              type="submit"
              form="{{ request.view_args.get("object_type") }}-table-search"
              name="sorting"
              value="{{ attribute }}:{{ "desc" if (sorting_direction == "asc" and sorting_attr == attribute) else "asc" }}">
                {{ L[attribute|capitalize] }} {% if sorting_attr == attribute %}{{ "[A-z]" if sorting_direction == "asc" else "[Z-a]" }}{% endif %}
      </button>
      {% endfor %}
    </div>
  </td>
</tr>
